<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PT. SMS - Inventory</title>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{font-family:Inter,sans-serif;background:#f3f4f6}
@media print {.no-print{display:none}}
</style>
</head>

<body>

<header class="bg-blue-800 text-white text-center p-6">
<h1 class="text-2xl font-bold">PT. SAMUDRA MANDIRI SENTOSA</h1>
<p class="text-xs tracking-widest">INVENTORY SYSTEM</p>
</header>

<div class="max-w-6xl mx-auto p-4 space-y-6">

<!-- STAT -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="bg-white p-4 rounded shadow">
<p class="text-xs text-gray-500">Jenis Barang</p>
<h2 id="statJenis" class="text-3xl font-bold text-blue-600">0</h2>
</div>
<div class="bg-white p-4 rounded shadow">
<p class="text-xs text-gray-500">Total Unit</p>
<h2 id="statTotal" class="text-3xl font-bold text-green-600">0</h2>
</div>
<div class="bg-white p-4 rounded shadow">
<p class="text-xs text-gray-500">Stok Menipis</p>
<h2 id="statTipis" class="text-3xl font-bold text-red-600">0</h2>
</div>
</div>

<!-- FORM -->
<div class="grid md:grid-cols-2 gap-6 no-print">

<!-- MASUK -->
<div class="bg-white p-6 rounded shadow">
<h3 class="font-bold mb-3 text-green-600"><i class="fa fa-box"></i> Barang Masuk</h3>
<input id="inNama" class="w-full p-2 border rounded mb-2" placeholder="Nama Barang">
<input id="inQty" type="number" class="w-full p-2 border rounded mb-2" placeholder="Jumlah">
<input id="inSatuan" class="w-full p-2 border rounded mb-3" placeholder="Satuan (pcs/kg)">
<button onclick="barangMasuk()" class="w-full bg-green-600 text-white py-2 rounded">Simpan</button>
</div>

<!-- KELUAR -->
<div class="bg-white p-6 rounded shadow">
<h3 class="font-bold mb-3 text-red-600"><i class="fa fa-truck"></i> Barang Keluar</h3>
<input id="outNama" class="w-full p-2 border rounded mb-2" placeholder="Nama Barang">
<input id="outQty" type="number" class="w-full p-2 border rounded mb-3" placeholder="Jumlah">
<button onclick="barangKeluar()" class="w-full bg-red-600 text-white py-2 rounded">Kurangi</button>
</div>

</div>

<!-- TABEL -->
<div class="bg-white rounded shadow overflow-x-auto">
<table class="w-full text-sm">
<thead class="bg-gray-100">
<tr>
<th class="p-3">Nama</th>
<th class="p-3 text-center">Stok</th>
<th class="p-3 text-right">Satuan</th>
</tr>
</thead>
<tbody id="tabel"></tbody>
</table>
</div>

</div>

<script>
/* ===== FIREBASE CONFIG ===== */
firebase.initializeApp({
 apiKey: "AIzaSyDbf4nf0iQleiB3R8Un89Gpi1Oio-tTB3o",
 authDomain: "gudang-sms-4c81c.firebaseapp.com",
 databaseURL: "https://gudang-sms-4c81c-default-rtdb.asia-southeast1.firebasedatabase.app",
 projectId: "gudang-sms-4c81c",
 storageBucket: "gudang-sms-4c81c.appspot.com",
 appId: "1:598362736106:web:c8e2732d6ac7613931de93"
});

const db = firebase.database();

/* ===== BARANG MASUK ===== */
function barangMasuk(){
const nama = inNama.value.trim();
const qty = parseInt(inQty.value);
const satuan = inSatuan.value || "pcs";

if(!nama || qty<=0) return alert("Isi data dengan benar");

const key = nama.replace(/\s+/g,'_').toLowerCase();
const ref = db.ref("stok/"+key);

ref.once("value").then(s=>{
const stok = s.exists()?s.val().stok:0;
ref.set({nama,stok:stok+qty,satuan});
inNama.value=inQty.value=inSatuan.value="";
});
}

/* ===== BARANG KELUAR ===== */
function barangKeluar(){
const nama = outNama.value.trim();
const qty = parseInt(outQty.value);
if(!nama || qty<=0) return alert("Isi data");

const key = nama.replace(/\s+/g,'_').toLowerCase();
const ref = db.ref("stok/"+key);

ref.once("value").then(s=>{
if(!s.exists()) return alert("Barang tidak ada");
if(s.val().stok < qty) return alert("Stok kurang");

ref.update({stok:s.val().stok-qty});
outNama.value=outQty.value="";
});
}

/* ===== LOAD DATA ===== */
db.ref("stok").on("value",snap=>{
let html="",jenis=0,total=0,tipis=0;

snap.forEach(c=>{
const d=c.val();
jenis++; total+=d.stok;
if(d.stok<10) tipis++;

html+=`
<tr class="border-b">
<td class="p-3">${d.nama}</td>
<td class="p-3 text-center font-bold">${d.stok}</td>
<td class="p-3 text-right">${d.satuan}</td>
</tr>`;
});

tabel.innerHTML=html;
statJenis.innerText=jenis;
statTotal.innerText=total;
statTipis.innerText=tipis;
});
</script>

</body>
</html