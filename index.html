<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

<script>
  // Konfigurasi Baru dari Foto 38
  const firebaseConfig = {
    apiKey: "AIzaSyDbf4nf0iQleiB3R8Un89Gpi1Oio-tTB3o",
    authDomain: "gudang-sms-4c81c.firebaseapp.com",
    databaseURL: "https://gudang-sms-4c81c-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "gudang-sms-4c81c",
    storageBucket: "gudang-sms-4c81c.firebasestorage.app",
    messagingSenderId: "598362736106",
    appId: "1:598362736106:web:c8e2732d6ac7613931de93"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // FUNGSI: Simpan Barang Masuk
  function simpanMasuk() {
    const nama = document.querySelector('input[placeholder="Cari Nama Barang"]').value;
    const jumlah = document.querySelector('input[type="number"]').value;

    if (nama && jumlah) {
      db.ref('stok/' + nama).once('value').then((snap) => {
        let stokLama = snap.exists() ? parseInt(snap.val().stok) : 0;
        db.ref('stok/' + nama).set({
          nama: nama,
          stok: stokLama + parseInt(jumlah),
          waktu: new Date().toLocaleString()
        }).then(() => alert("Stok " + nama + " berhasil ditambah!"));
      });
    }
  }

  // FUNGSI: Tampilkan ke Tabel secara Real-time (HP & Laptop Sinkron)
  db.ref('stok').on('value', (snapshot) => {
    const data = snapshot.val();
    const tabel = document.querySelector('table tbody'); // Perbaikan 'tbody', bukan 'thody'
    if (tabel) {
      tabel.innerHTML = "";
      for (let id in data) {
        tabel.innerHTML += `<tr>
          <td>-</td>
          <td>${data[id].nama}</td>
          <td>${data[id].stok}</td>
          <td>pcs</td>
        </tr>`;
      }
    }
  });
</script>