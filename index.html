<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Sistem Gudang</title>

<style>
body{
  font-family:Arial;
  background:#f4f6f8;
  margin:0;
  padding:20px;
}
h2{margin-top:0}

.card{
  background:#fff;
  padding:15px;
  border-radius:8px;
  margin-bottom:15px;
}

.dashboard{
  display:flex;
  gap:10px;
}
.box{
  flex:1;
  background:#fff;
  padding:15px;
  border-radius:8px;
  text-align:center;
}
.box h3{margin:0;font-size:14px;color:#666}
.box span{font-size:22px;font-weight:bold}

input,select,button{
  width:100%;
  padding:8px;
  margin-top:6px;
}
button{
  background:#0d6efd;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
button:hover{opacity:0.9}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  border:1px solid #ddd;
  padding:6px;
  text-align:center;
}
th{background:#f1f1f1}
</style>
</head>

<body>

<h2>Sistem Gudang</h2>

<!-- DASHBOARD -->
<div class="dashboard">
  <div class="box">
    <h3>Total Stok</h3>
    <span id="totalStok">0</span>
  </div>
  <div class="box">
    <h3>Masuk</h3>
    <span id="masuk">0</span>
  </div>
  <div class="box">
    <h3>Keluar</h3>
    <span id="keluar">0</span>
  </div>
</div>

<!-- FORM -->
<div class="card">
  <h3>Tambah Transaksi</h3>

  <input id="barang" placeholder="Nama Barang">
  
  <select id="jenis">
    <option value="masuk">Barang Masuk</option>
    <option value="keluar">Barang Keluar</option>
  </select>

  <input id="jumlah" type="number" placeholder="Jumlah">

  <button onclick="simpan()">Simpan</button>
</div>

<!-- RIWAYAT -->
<div class="card">
  <h3>Riwayat Transaksi</h3>
  <table>
    <thead>
      <tr>
        <th>Tanggal</th>
        <th>Barang</th>
        <th>Jenis</th>
        <th>Jumlah</th>
      </tr>
    </thead>
    <tbody id="riwayat"></tbody>
  </table>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDbf4Nf0J0ELJ3B3R8Un8Ypgi0io-TB30",
  authDomain: "gudang-sms-4c81c.firebaseapp.com",
  databaseURL: "https://gudang-sms-4c81c-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "gudang-sms-4c81c",
  storageBucket: "gudang-sms-4c81c.firebasestorage.app",
  messagingSenderId: "598362736106",
  appId: "1:598362736106:web:c0e2732d6ac7513931de93"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* SIMPAN DATA */
function simpan(){
  const barang = document.getElementById("barang").value;
  const jenis  = document.getElementById("jenis").value;
  const jumlah = parseInt(document.getElementById("jumlah").value);

  if(!barang || !jumlah){
    alert("Lengkapi data!");
    return;
  }

  db.ref("riwayat").push({
    barang: barang,
    jenis: jenis,
    jumlah: jumlah,
    tanggal: new Date().toLocaleString()
  });

  document.getElementById("barang").value="";
  document.getElementById("jumlah").value="";
}

/* LOAD RIWAYAT + DASHBOARD */
db.ref("riwayat").on("value", snap=>{
  let html="";
  let total=0, m=0, k=0;

  snap.forEach(x=>{
    const d=x.val();
    if(d.jenis==="masuk"){
      total+=d.jumlah; m+=d.jumlah;
    }else{
      total-=d.jumlah; k+=d.jumlah;
    }

    html+=`
      <tr>
        <td>${d.tanggal}</td>
        <td>${d.barang}</td>
        <td>${d.jenis}</td>
        <td>${d.jumlah}</td>
      </tr>`;
  });

  document.getElementById("riwayat").innerHTML=html;
  document.getElementById("totalStok").innerText=total;
  document.getElementById("masuk").innerText=m;
  document.getElementById("keluar").innerText=k;
});
</script>

</body>
</html>
