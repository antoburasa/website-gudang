<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

<script>
  // Data Konfigurasi dari Foto 39 kamu
  const firebaseConfig = {
    apiKey: "AIzaSyDbf4nf0iQleiB3R8Un89Gpi1Oio-tTB3o",
    authDomain: "gudang-sms-4c81c.firebaseapp.com",
    databaseURL: "https://gudang-sms-4c81c-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "gudang-sms-4c81c",
    storageBucket: "gudang-sms-4c81c.firebasestorage.app",
    messagingSenderId: "598362736106",
    appId: "1:598362736106:web:c8e2732d6ac7613931de93"
  };

  // Inisialisasi Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Fungsi untuk Simpan Barang Masuk
  function simpanMasuk() {
    const nama = document.querySelector('input[placeholder="Cari Nama Barang"]').value;
    const jumlah = document.querySelector('input[type="number"]').value;

    if (nama && jumlah) {
      const ref = db.ref('stok/' + nama);
      ref.once('value').then((snap) => {
        let stokLama = snap.exists() ? parseInt(snap.val().stok) : 0;
        ref.set({
          nama: nama,
          stok: stokLama + parseInt(jumlah),
          waktu: new Date().toLocaleString()
        }).then(() => {
          alert("Stok " + nama + " berhasil ditambah!");
        });
      });
    } else {
      alert("Mohon isi nama barang dan jumlah!");
    }
  }

  // Fungsi untuk Menampilkan Data secara Real-time ke Tabel
  db.ref('stok').on('value', (snapshot) => {
    const data = snapshot.val();
    const tabelBody = document.querySelector('table tbody'); // Perbaikan 'tbody' agar data muncul
    
    if (tabelBody) {
      tabelBody.innerHTML = "";
      for (let key in data) {
        tabelBody.innerHTML += `
          <tr>
            <td>-</td>
            <td>${data[key].nama}</td>
            <td>${data[key].stok}</td>
            <td>pcs</td>
          </tr>`;
      }
    }
  });
</script>